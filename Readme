I. Building a package.

1. Create directory 'project'.

2. In that directory, create directory 'aps2' and copy modules there, like follows:

$ ls aps2

aps.py  apsapi.py  mylogger.py  runtime.py  uLogging.py

3. Create __init__.py module in aps directory, containing __all__ array, listing the modules:

$ cat aps2/__init__.py 
__all__ = ["aps2"]

4. In directory 'project', create setup.py, with the following context:

$ cat setup.py 
#!/usr/bin/env python

from distutils.core import setup
setup(
    name = "aps-python-runtime",
    packages = ["aps2"],
    version = "2.0-5",
    description = "Runtime package for aps 2.x applicaitons in Python"
)

5. Now, we can install package using the following command:

python setup.py install

6. Alternatively, create a tar archive and install it using pip:

tar czvf aps.tgz setup.py  aps2
pip install aps.tgz

Installing pip utility:

1. wget https://bootstrap.pypa.io/get-pip.py
2. python get-pip.py

II. Setup application

1. Install mod_wsgi:

yum install mod_wsgi

2. Create application directory, for example:

mkdir /usr/local/share/applications/pycloud
chown apache:apache /usr/local/share/applications/pycloud

3. Copy application modules into this directory:

# ls /usr/local/share/applications/pycloud
clouds.py  contexts.py  

4. Create module /usr/local/share/applications/pycloud/handler.py, with the following content:

# cat /usr/local/share/applications/pycloud/handler.py 
import aps2.runtime

import sys

sys.path.append('/usr/local/share/applications/pycloud/')

application = aps2.runtime.application

5. Create http config for the application:

# cat /etc/httpd/conf.d/myapp.conf
WSGIScriptAlias /endpoint002 /usr/local/share/applications/pycloud/handler.py

6. Restart httpd:

service httpd restart

7. Check endpoint url

Endpoint URL will be https://<hostname>/endpoint002

For example: http://endpoint.a.apscloudstest.apsdemo.org/endpoint002

Try to access it from browser. It should return status 500 and error message:

Error: APS-Controller-URI header is not set 

III. Configure application in POA

1. Import application

etc. etc.



